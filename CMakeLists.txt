set(TAICHI_PROJECT_NAME "pangu")
#file(GLOB_RECURSE PROJECT_SOURCES "lang/*.cpp" "lang/*.h" "pangu/*.cpp" "pangu/*.h" "headers/*.h")
file(GLOB_RECURSE PROJECT_SOURCES "lang/*.cpp" "lang/*.h" "headers/*.h")
include_directories(include)
set(SRC_DIR "${CMAKE_CURRENT_SOURCE_DIR}/src")
set(TAICHI_PROJECT_LIBRARIES ${TAICHI_PROJECT_LIBRARIES} ${TAICHI_PROJECT_NAME} PARENT_SCOPE)

add_subdirectory(external/partio)
include_directories(external/partio/include)
#set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -fopenmp")

add_library(taichi_pangu SHARED ${PROJECT_SOURCES})
target_link_libraries(taichi_pangu ${CORE_LIBRARY_NAME} partio)

find_package(CUDA 8.0)
if (CUDA_FOUND)
    set(CUDA_ARCH 61)
    message("Found CUDA. Arch = ${CUDA_ARCH}")
    include_directories(/usr/local/cuda/include)
    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -DCUDA_FOUND")
    target_link_libraries(taichi_pangu /usr/local/cuda/lib64/libcudart.so)
else()
    message("CUDA Not Found.")
endif()

# find_package(MPI 3.1 REQUIRED)
# include_directories(SYSTEM ${MPI_INCLUDE_PATH})
# target_link_libraries(taichi_pangu ${MPI_C_LIBRARIES})
